2004.10.25 By K. Matsumoto @ National Astronomical Observatory

1. GOTIC2 

GOTIC2 は GOTIC (Sato and Hanada, 1984) の改良版です。陸上の
点について、固体地球潮汐および海洋潮汐の影響量を計算するプロ
グラムです。海洋潮汐の影響量（荷重潮汐）は Farrell (1972)の
convolution method で計算します。FORTRAN で記述されており、
現在Linux、AIX4.3、HP-UX、およびWINDOWS XP上での動作確認が
されています。

GOTIC に対する主な変更点は、
(1)TOPEX/POSEIDON 海面高度計データに基づいた新しい海洋潮汐モ
   デル(NAO.99b & NAO.99Jbモデル)対応になったこと、
(2)対応分潮数が21に増えたこと、
(3)制御ファイルの書式が変更になったこと、
(4)時系列予測機能が追加されたことです。

最新ヴァージョンは2004.10.25です。更新履歴はこのファイルの最
後にあります。

GOTIC2に対する適当なReferenceは
Matsumoto, K., T. Sato, T. Takanezawa, and M. Ooe,
GOTIC2: A Program for Computation of Oceanic Tidal Loading Effect, 
J. Geod. Soc. Japan, 47, 243-248, 2001.
です。


2. 海洋潮汐モデル

○短周期海洋潮汐モデル (NAO.99b & NAO.99Jb モデル)
  主要16分潮(M2, S2, K1, O1, N2, P1, K2, Q1, M1, J1, OO1,
  2N2, Mu2, Nu2, L2, T2)のグローバルモデルと日本周辺モデルが
  用意されています。各モデルの領域と解像度は次のようになって 
  います。
                                      領域                解像度
  グローバルモデル(NAO.99b)    0°E-360°E, 90°S-90°N    0.5°
  日本周辺モデル  (NAO.99Jb) 110°E-165°E, 20°N-65°N    1/12°(5分)

  グローバルモデルは、約5年分のTOPEX/POSEIDON海面高度計デー
  タ(Cycle 9-198)を潮汐解析し、流体力学数値モデルに同化して
  構築されました。また、日本周辺モデルは、TOPEX/POSEIDONデー
  タに加えて、沿岸の検潮データも同時に同化して作成されました。

  これらのモデルの詳細については、
  Matsumoto, K., T. Takanezawa, and M. Ooe,
  Ocean Tide Models Developed by Assimilating TOPEX/POSEIDON
  Altimeter Data into Hydrodynamical Model: A Global Model
  and a Regional Model around Japan,
  Journal of Oceanography, 56, 567-581, 2000.
  をご参照下さい。

○長周期海洋潮汐モデル (NAO.99Lモデル)
  Mtm, Mf, Mm, Ssa, Sa分潮のグローバルモデルが利用できます。
  これらのモデルは純粋な流体力学数値モデルです(TOPEX/POSEID-
  ONデータは同化されていません)。領域と解像度は次のようになっ
  ています。 
                            領域                解像度
  Mtm, Mf, Mm, Ssa   0°E-360°E, 90°S-90°N    0.5°
  Sa                 0°E-360°E, 90°S-90°N    1.0°

  Sa分潮モデルのもともとの解像度は1.0°ですが、計算の都合上、
  0.5°の解像度にリサンプリングした潮汐マップが使われていま
  す。NAO.99にはMSf, MSm分潮も含まれていますが、GOTIC2はまだ
  これらの分潮には対応していません。     
  
  これら長周期モデルについては、
  Takanezawa, T., K. Matsumoto, M. Ooe, and I. Naito,
  Effects of the Long-period Ocean Tide on Earth Rotation,
  Gravity and Crustal Deformation Predicted by Global
  Barotropic Model -periods from Mtm to Sa-,
  J. Geod. Soc. Japan, 47, 545-550, 2001.
  をご参照下さい。


3. 計算メッシュ

GOTIC2 は大きさの異なる4種類の海陸分布を表すメッシュを用いて
海洋潮汐の影響量を計算します。それぞれのメッシュサイズは、次
の通りです。
                       メッシュサイズ
1次メッシュ   0.5°×0.5°(1800"× 1800")
2次メッシュ   7.5' ×5'   ( 450"×  300")・・・日本国内の場合
              5'   ×5'   ( 300"×  300")・・・日本以外の場合
3次メッシュ   45"  ×30"
4次メッシュ   2.25"×1.5" (日本国内で約50m×50m)

海洋潮汐の見積もりを行う点(以下、観測点と表記)に近い領域ほど
細かいメッシュが使用されます。日本以外の領域については2次メッ
シュまでしか用意されていません。

○日本国内の観測点の場合
  3次メッシュまで自動的に読み込まれます。4次メッシュを使用す
  る場合にはMESH4 ONを制御ファイルに追加して下さい。

○日本以外の観測点の場合
  2次メッシュまで自動的に読み込まれます。3次、4次メッシュを
  用いる場合は、ユーザーがメッシュファイルを更新する必要があ
  ります。


4. Green 関数

GOTIC 同様、Farrell (1972)による G-B 地球モデルに基づく 
Green 関数と遠藤・大久保(1983)による 1066A 地球モデルに基づ 
く Green 関数の何れかを選択できます。


5. 潮汐成分

次の6種類の潮汐成分の振幅と位相が計算できます。
(1) 上下変位
(2) 水平変位
(3) 重力
(4) 傾斜
(5) 歪
(6) 鉛直線変化

 
6. 制御ファイル

GOTIC2 は標準入力から制御ファイルを読み込み、処理すべき情報
を得ます。制御ファイルはカードと呼ばれる制御語とそれに続くパ
ラメータで記述されます。GOTIC2 を走らせる上で不可欠なカード
（観測点位置、分潮、成分を指定するカード）とオプションカード
があり、後者は細かい設定を行うときに使用します。このカードと
いう概念は軌道予測・重力場推定プログラムGEODYN IIで採用され
ているのを参考にしました。はじめはとっつきにくいかもしれませ
んが、慣れると使いやすいです(^_^)。

制御ファイルの各行は100文字を超えないように注意して下さい。
 
6-1. 不可欠カード

・STAPOSD カード
  潮汐荷重を求める観測点の位置を指定します。
  書式 : STAPOSD 観測点名, 経度(度), 緯度(度), 高度(m), 方位角(度)
  例   : STAPOSD ESASHI  , 141.3352777, 39.14805555555555, 393.0, 390.0
  注   : 観測点名はアルファベット10文字以下にして下さい。
         すべてのフィールドを埋めて下さい。例えば、重力など
         方位角が関係ない場合でも、方位角の所を 0.0 で埋め
         るなどして下さい。

         方位角は例えば傾斜計がきっちり東西または南北方向に
         伸びていない時にその基線の方向を指定する場合に用い
         ます。北から時計周りに計った角度を指定します。

・STAPOS カード
  潮汐荷重を求める観測点の位置を指定します。
  書式 : STAPOS 観測点名, 経度(度), 経度(分), 経度(秒),
                緯度(度), 緯度(分), 緯度(秒), 高度(m), 方位角(度)
  例   : STAPOS  MATSUSHIRO, 138, 12, 25.25, 36, 32, 33.63, 405.9 , 390.0
  注   : 観測点名はアルファベット10文字以下にして下さい。
         すべてのフィールドを埋めて下さい。例えば、重力など
         方位角が関係ない場合でも、方位角の所を 0.0 で埋め
         るなどして下さい。方位角は北から時計周りに計った角
         度を指定します。 

・KIND カード
  潮汐成分の種類を指定します。
  書式 : KIND 潮汐成分1, 潮汐成分2,・・・
  例   : KIND RD, HD, GV, TL, ST, DV
  注   : 大文字アルファベットで記述して下さい。
　　　　 RD 上下変位(Radial Displacement)
         HD 水平変位(Horizontal Displacement)
         GV 重力(GraVity)
         TL 傾斜(TiLt)
         ST 歪(STrain)
         DV 鉛直線変化(Deflection of the Vertical)
         の内少なくとも一つを指定して下さい。

・WAVE カード
  分潮を指定します。
  書式 : WAVE 分潮名1, 分潮名2,・・・
  例   : WAVE M2, S2, K1, O1, N2, P1, K2, Q1
  注   : M2, S2, K1, O1, N2, P1, K2, Q1, M1, J1, OO1, 2N2,
         Mu2, Nu2, L2, T2, Mtm, Mf, Mm, Ssa, Sa の内少なくと
         も一つを指定して下さい。Case sensitive であることに
         注意して下さい。ピリオド','は省略してもかまいません。

         2行以上にわたって記述しても有効です。すなわち、
         WAVE M2, S2, K1, O1, N2, P1, K2, Q1
         と、
         WAVE M2 S2 K1 O1
         WAVE N2,P1,K2,Q1
         は同じです。

　　　　 また、エイリアスとして、
         WAVE MAJOR8         (主要8分潮)
         WAVE SHORTP         (短周期潮汐16分潮)
         WAVE LONGP          (長周期潮汐 5分潮)
         WAVE ALL            (短周期潮汐16分潮+長周期潮汐5分潮)
         が使えます。例えば、
         WAVE MAJOR8 LONGP
         と
         WAVE M2,S2,K1,O1,N2,P1,K2,Q1, Mtm,Mf,Mm,Ssa,Sa
         は同じです。

STAPOSD, STAPOS カードはどちらか都合の良い方を使用して下さい。
2点以上の観測点についての計算を行うときにはSTAPOSDまたは
STAPOSカードを2行（またはそれ以上10行以下）にわたって記述し
てください（10観測点まで一度に計算できます）。
不可欠カードを入力すればとりあえず計算は行われます。その際に
は他のパラメータにはデフォルト値がセットされます（オプション
カードの説明参照）。

下の例では、ESASHI, MATSUSHIRO の2点について、M2, K1分潮の重
力の計算がされます。
STAPOSD ESASHI  , 141.3352777, 39.14805555555555, 393.0, 390.0
STAPOS  MATSUSHIRO, 138, 12, 25.25, 36, 32, 33.63, 405.9 , 390.0
KIND    GV
WAVE    M2 K1

6-2. オプションカード

・INTEGA カード
  畳み込み積分を実行する領域を観測点を中心とする環状の領域で
  指定します。 
  書式 : INTEGA 内径(度), 外径(度)
  例   : INTEGA 0.0, 180.0
  デフォルト値 : 内径 = 0.0 度, 外径 = 180.0 度 (すなわち全球積分)

・BOUND12 カード
  1次メッシュを用いる領域を、観測点からの角距離で指定します。
  書式 : BOUND12 角距離(度)
  例   : BOUND12 10.0
  デフォルト値 : 10.0
  注   : 指定された角距離より遠い領域は1次メッシュを用いて計
         算されます。最大値は60.0です。

・BOUND23 カード
  2次メッシュを用いる領域を観測点からの角距離で指定します。
  書式 : BOUND23 角距離(度)
  例   : BOUND23 5.0
  デフォルト値 : 5.0
  注   : BOUND12で指定された角距離より近く、BOUND23で指定
         された角距離より遠い領域に存在する2次メッシュが用い
         られます。最大値は30.0です。 

・BOUND34 カード
  3次メッシュを用いる領域を観測点からの角距離で指定します。
  書式 : BOUND34 角距離(度)
  例   : BOUND34 0.2
  デフォルト値 : 0.2
  注   : BOUND23で指定された角距離より近く、BOUND34で指定
        された角距離より遠い領域に存在する3次メッシュを用い
        ます。最大値は30.0です。 

・MESH3 カード
  メッシュファイルから3次メッシュを読み、計算に利用する事を
  要請します。予め3次メッシュが用意されていないと意味があり
  ません。日本国内については用意されています。 
  書式 : MESH3 ON or OFF 
  例   : MESH3 ON
  デフォルト値 : ON  ・・・日本国内の場合
               : OFF ・・・日本以外の場合

・MESH4 カード
  メッシュファイルから4次メッシュを読み、計算に利用する事を
  要請します。予め4次メッシュが用意されていないと意味があり
  ません。日本国内については用意されています。 
  書式 : MESH4 ON or OFF 
  例   : MESH4 ON
  デフォルト値 : OFF

・MAPOUT カード
  GMT用のメッシュ情報の出力を要請します。
  書式 : MAPOUT index(1:陸率100%のメッシュを出力、
                      2:完全に陸ではないメッシュを出力),
                西端の東経,東端の東経,南端の北緯,北端の北緯
  例   : MAPOUT  1, 140.0, 142.0, 38.0, 40.0
  注   : このカードがあると、指定された領域内のメッシュの座
         標情報が mapout.xy というファイルに書き出されます。
         このファイルは GMT の psxy コマンドに食わせる事によっ
         て、メッシュを描いた PS ファイルを作ることが出来ま
         す。南緯については、負の北緯として指定してください。

         STAPOS(D) カードで最初に指定された観測点の、 KIND
         カードで最初に指定された潮汐成分の、WAVEカードで最
         初に指定された分潮に対してのみ出力が行われます。

・GREENF カード
  GREEN関数を指定します。
  書式 : GREENF GREEN関数番号(1 = G-Bモデル, 2 = 1066Aモデル)
  例   : GREENF 2
  デフォルト値 : 2

・POINTL カード
  点荷重として計算するかどうかを指定します。
  書式 : POINTL ON or OFF
  例   : POINTL OFF
  デフォルト値 : OFF
  注   : GOTIC2 はデフォルトで観測点からの角距離が30度以遠の
         領域は点荷重として扱われますが、角距離が30度以内の
         領域については、GREEN関数をメッシュ内で積分して精度
         向上を図っています。POINTL ON にすると、30度以内の
         領域でも点荷重として扱います。精度が落ちるかわりに
         計算速度が向上します。 

・MASSCON カード
  海洋潮汐モデルに対して、強制的に質量保存を行うかどうかを指
  定します。
  書式 : MASSCON ON or OFF
  例   : MASSCON ON
  デフォルト値 : ON

・PATAN2 カード
  位相の出力形式を指定します。
  書式 : PATAN2 ON or OFF
  例   : PATAN2 OFF
  デフォルト値 : OFF
  注   : ON の場合、-180度〜180度で表示され、OFFの場合0度〜
         360度で表示されます。

・VERBOUS カード
  詳細な出力を要請します。
  書式 : VERBOUS ON or OFF
  例   : VERBOUS OFF
  デフォルト値 : ON

・DELTAF カード
  重力の固体地球潮汐を計算する際に使用するデルタファクタを指
  定します。　
  書式 : DELTAF デルタファクタ番号
         (1 = Wahr, 2 = Dehant and Ducarme)
  例   : DELTAF 2
  デフォルト値 : 2
  注   : 重力以外の計算には無関係です。

・GTIME カード
  重力の固体地球潮汐の振幅を計算する際に、Tamuraのポテンシャ
  ルにある小さな時間変化項を考慮に入れます。重力観測との比較
  を念頭においたカードです。観測の行われた期間の中心の時刻を
  与えます。
  書式 : GTIME 年, 月, 日
  例   : GTIME 1996, 1, 1
  注   : 年は、1900年から2100年までの間で指定して下さい。
         重力以外の計算には無関係です。

・DATADIR カード
  GOTIC2 を実行するディレクトリをカレントディレクトリと仮定
  すると、GOTIC2 は ./data というディレクトリからGREEN関数ファ
  イルを、./data/omapというディレクトリから海洋潮汐モデルファ
  イルを、./data/meshというディレクトリからメッシュファイル
  を読み込みます。この./dataというディレクトリを変更したい場
  合にこのカードを使用します。 
  書式 : DATADIR ディレクトリ名
  例   : DATADIR /home/uname/any/dir/you/like/
  デフォルト値 : ./data/
  注   : ディレクトリ名は80文字を超えないようにして下さい。

・FULLMESH カード
  メッシュファイルには「全陸」または「全海」のメッシュ情報は
  含まれておらず、陸と海が混ざったメッシュに対してのみ海陸分
  布を細かく記述した情報が格納されています(4次メッシュは除く)。
  GOTIC2は「全海」のメッシュサイズが多少大きくてもその領域内
  でグリーン関数を角距離に対する2次の多項式で近似して積分す
  ることによって計算量の軽減を図っています。ただし、グリーン
  関数の変動が激しい(例えば地表ではなく、地下ボアホールのセ
  ンサー位置でのグリーン関数の場合など)領域では、全海メッシュ
  であっても細かく分割したほうが安全な場合があります。このカー
  ドを用いると、全海メッシュをサブグリッドに分割した計算が行
  われます。ただし、計算時間は増大します。   
  書式 : FULLMESH ON or OFF
  例   : FULLMESH ON
  デフォルト値 : OFF

・OMODEL カード
  NAO.99bモデル以外の海洋潮汐モデルに基づいた計算を要請しま
  す。
  書式 : OMODEL suffix
  例   : OMODEL got
  デフォルト値 : nao
  注   : 例えば、M2分潮の海洋潮汐モデルはm2.naoといったファ
         イル名で指定されますが、拡張子を変えることによって
         使用するモデルを選択出来ます。現在、NAO.99bモデルの
         他に、GOT99.2b、CSR4.0、Schwiderskiモデルが使用でき
         ます。
         GOT99.2bを用いるときは、
         OMODEL got
         CSR4.0を用いるときは、
         OMODEL csr
         Schwiderskiモデルを用いるときは、
         OMODEL sch
         と書いて下さい。
        

・UNIT6 カード
  標準出力にファイル名を指定します。
  書式 : UNIT6 出力ファイル名
  例   : UNIT6 result.out
  注   : GOTIC2 は標準入力から制御ファイルを読み込み、標準出
         力に計算結果を出力します。したがって、使い方の例を
         書くと、 
         % gotic2 < controle_file > result.out 
         のようになりますが、UNIT6 カードで出力ファイルを指
         定する事もできます。この場合、コマンドラインで
         % gotic2 < controle_file
         のようにして使います。
  
         出力ファイル名は80文字を超えないようにして下さい。

・UNIT20 カード
  潮汐時系列予測結果を出力するファイル名を指定します。
  書式 : UNIT20 出力ファイル名
  例   : UNIT20 predict.out
  注   : GOTIC2 は unit 20 に潮汐時系列予測結果を出力します。
         これにファイル名をつけたいときにこのカードを使用し
         ます。

         出力ファイル名は80文字を超えないようにして下さい。

・PREDICT カード
  潮汐時系列予測を行うPREDICTモードであることを宣言します。
  書式 : PREDICT 要素(1:固体潮汐＋海洋荷重、 2:固体潮汐、3:海
                 洋荷重), 開始時刻(UTC), 終了時刻(UTC), 時間
                 間隔(分) 
  例   : PREDICT 1, 199906081200, 199907011300, 60
  注   : STAPOS(D) カードで最初に指定された観測点の、KIND カー
         ドで最初に指定された潮汐成分に対して、WAVE カードで
         指定された分潮を足しあわせて予測を行います。予測結
         果は unit 20 に出力されます。 

         開始・終了時刻は12桁の数字で指定して下さい。上の例
         では開始時刻=1999年6月8日12時00分UTC、終了時刻=1999
         年7月1日13時00分UTCの間で60分間隔で予測を行います。

         開始・終了時刻は1900年3月1日から2100年2月28日までの
         間で指定してください。

         !!! 固体地球潮汐については高々21分潮の足し合わせで
         は十分な精度はでません。これについては近い内に
         Tamuraのポテンシャルを用いてもっと多くの分潮を考慮
         に入れる方向で改良していきたいと考えています。

・PREXFL カード
  GOTIC2で計算した振幅・位相を読み込んで予測を行います。
  書式 : PREXFL 読み込むファイル名。
  例   : PREXFL result.out
  注   : 時系列予測を行う際には、各分潮の調和定数が必要とな
         ります。例えば同じ観測点で期間の異なる時系列予測を
         何回も行う場合には、あらかじめ調和定数を計算してファ
         イルに保存しておくのが経済的です。このカードは読み
         込む外部ファイル名を指定します。この外部ファイルは
         調和定数を計算するために走らせたGOTIC2の標準出力で
         す。    
         
         必ず PREDICT カードも同時に記述してください。
         ファイル名は80文字を超えないようにして下さい。
         調和定数を計算したときに指定したSTAPOS(D)、KIND、
         WAVE カードの内容が PREDICT モードで指定した内容と
         一致している事を確認してください。 

         PREDICT カードが存在し、PREXFL カードが存在しない場
         合には調和定数の計算をした後時系列予測が行われます。
         PREDICT カードと PREXFL カードが同時に存在する場合
         には時系列予測のみが行われ、convolutionは行われませ
         ん。

・PREFMT カード
  時系列予測の出力フォーマットを指定します。
  書式 : PREFMT 時刻フォーマット番号(1-5), 符号・単位番号(1-4)
  例   : PREFMT 5, 1
  デフォルト値 : 5, 1
  注   : 必ず PREDICT カードも同時に記述してください。

         時刻フォーマット番号            時刻
                 1              開始時刻からの経過日(day)
                 2              開始時刻からの経過時間(hour)
                 3              開始時刻からの経過分(minute)
                 4              開始時刻からの経過秒(second)
                 5              年/月/日 時:分:秒
         
         符号・単位番号
                 1       RD : upward positive (m)
                         HD : northward, eastward positive (m)
                         GV : upward positive (m/s/s)
                         TL : upward-N, upward-E,
                              upward-Azimuth positive (rad)
                         ST : extension positive (無次元)
                         VD : upward-N, upward-E positive (rad)
                 2       符号は1と同じ。単位は RD (mm)、HD (mm)、
                         GV (microGal)、TL (nanorad)、
                         ST*10^9 (無次元)、DV (nanorad)
                 3       符号は1と逆、単位は1と同じ。
                 4       符号は1と逆、単位は2と同じ。

・PRE186 カード
  時系列予測の際18.6年のサイドバンドを考慮に入れるかどうかを
  指定します。 
  書式 : PRE186 ON or OFF
  例   : PRE186 ON
  デフォルト値 : ON

・PREOUT カード
  UNIT20 カードと同じです。

・END カード
  カードの並びの終わりを宣言します。
  書式 : END
  例   : END
  注   : 特に無くても良いのですが、ENDカードの後にコメント等
         を書くときに便利です。

6-3. コメントアウト

各カードはその行の第1列目から始まらない限り認識されません。
これを利用して、行の始めに # 等を入れてコメントアウトされた
と解釈させることができます。例えば、 
#KIND    RD, HD, GV, TL, ST, DV
KIND    GV
と書いた場合、はじめのKINDカードは無視され、計算は次の
KIND カードで指定された重力についてのみ行われます。

また、オプションカードが重複して書かれている場合は、後で出て
くるカードで以前の情報が上書きされます。


7. メッシュファイルの記述方法

ここでは、経度方向を横、緯度方向を縦として話を進めます。
1次メッシュは全球を0.5度に分割した横720x縦360個のメッシュか
らなります。data/mesh/1stmesh.dataにこの情報は格納されていま
す。(m1,n1)のメッシュの中心座標を(x1度,y1度)とすると、
x1 =  0.0 + (m1-0.5)*0.5
y1 = 90.0 - (n1-0.5)*0.5
となります。一つのメッシュには次の11のメッシュ情報の何れかが
割り当てられます。
123456789#.
.は全海を、#は全陸を、数字は陸率情報を表します。例えば、
0 .gt. 陸率 .le. 0.1111111 の場合に陸率情報は1となります。メッ
シュ情報として.および#以外の数字があるということは、この海陸
混在メッシュを表すべきさらに高次のメッシュ情報がその後に続い
て現れることを意味します。
プログラム内では、整数で表された「陸率」情報iar1を用いて
ar0 = (9.5d0-dfloat(iar1))/9.0d0 として計算され 
る「海率」の平均値が用いられます。

ある1次メッシュを分割した高次メッシュ情報は1次メッシュ毎にそ
れぞれ個別のファイルに記述されます。例えば(129.75度,33.75度)
を中心に持つメッシュ(m1,n1)=(260,113)の場合、
data/mesh/260113.meshというファイルに分割情報が記述されます。

一行目に親メッシュ(2次の親メッシュは1次メッシュ、3次の親メッ
シュは2次メッシュ)が子メッシュによってどのように分割されるか
を(3i6)のフォーマットで書きます。例えば、
  4  6 10 10 20 20
は、1次メッシュをx方向に4分割、y方向に6分割して2次メッシュと
し、2次メッシュをx方向に10分割、y方向に10分割して3次メッシュ
とし、3次メッシュをx方向に20分割、y方向に20分割して4次メッシュ 
とすることを意味します。国土地理院発行の50mメッシュ数値地図
に合わせて、日本国内についてはこの分割方式が適用されています。
日本以外の地域については、1次メッシュをx方向、y方向それぞれ6
分割して2次メッシュとしています。

二行目には2次メッシュ情報を(i1,2i3,24a1)で書きます。
iar1,m1,n1,(cmesh2(m2,n2),m2=1,4),n2=1,6)
例えば、

2260113.....21..62..3111.111124

は(m1,n1)=(260,113)の陸率情報は2であり、その中は2次メッシュ
を用いて

....
.21.
.62.
.311
1.11
1124

と分割されることを意味します。

3次メッシュ以降も同様に記述します。3次メッシュ情報は、
(i1,2i3,2i1,100a1)のフォーマットで次のように書きます。
iar2,m1,n1,m2,n2,(cmesh3(m3,n3),m3=1,10),n3=1,10)
例えば、上の例の(m2,n2)=(2,2)の分割情報は

226011322......................................................11........544........373......29##64...18#####

のようになります。これは、(m1,n1,m2,n2)=(260,113,2,2)で指定
される2次メッシュの陸率情報は2であり、その中は3次メッシュを
用いて

..........
..........
..........
..........
..........
....11....
....544...
.....373..
....29##64
...18#####

と分割されることを意味します。

4次メッシュの情報は、(i1,2i3,2i1,2i2,400a1)のフォーマットで
次のように書きます。
iar3,m1,n1,m2,n2,m3,n3,(cmesh4(m4,n4),m4=1,20),n4=1,20)
例えば、上の例の(m3,n3)=(5,6)の分割情報は

126011322 5 6..................................................................................................................................................................................................................................................................................##..................##.........................................................................#####..####.......#######..####

のようになります。これは、(m1,n1,m2,n2,m3,n3)=
(260,113,2,2,5,6)の陸率情報は1であり、その中は4次メッシュ
によって

....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
....................
..............##....
..............##....
....................
....................
....................
.........#####..####
.......#######..####

と分割されることを意味します。4次より細かいメッシュは今の所
無いので、4次メッシュは全て.か#で記述されます。

GOTIC2は順次細かくなるメッシュ情報をシーケンシャルに探してい
きます。従って、ある1次メッシュファイルの中身は、

メッシュ分割情報
2次メッシュ情報
3次メッシュ情報 ---------------------+
4次メッシュ情報 -+ (海陸混在3次      |-----+
4次メッシュ情報  | メッシュの数      |     |
4次メッシュ情報 -+ だけ記述) --------+     |
3次メッシュ情報 ---------------------+     |
4次メッシュ情報 -+ (海陸混在3次      | (海陸混在2次
4次メッシュ情報  | メッシュの数      | メッシュの数
4次メッシュ情報 -+ だけ記述) --------+　だけ記述)
3次メッシュ情報 ---------------------+     |
4次メッシュ情報 -+ (海陸混在3次      |     |
4次メッシュ情報  | メッシュの数      |-----+
4次メッシュ情報 -+ だけ記述) --------+ 

のようになることに注意して下さい。メッシュリストの順番が狂っ
ていると、GOTIC2は必要なメッシュを探すことが出来ず、ファイル
の終わりを検知して止まります。


8. インストール方法

必要なファイルは、
gotic2_041025.tar.gz
nao99b.tar.gz
nao99Jb.tar.gz
nao99L.tar.gz
(got992b.tar.gz  GOT99.2b モデルを使いたい場合)
(csr4.tar.gz     CSR4.0   モデルを使いたい場合)
です。

以下は UNIX 上での作業を想定して書いてあります。

nao99bディレクトリを作ります。
(~): mkdir nao99b
(~): cd nao99b/

omapディレクトリを作ります。
(~/nao99b): mkdir omap
(~/nao99b): cd omap

omapディレクトリでnao99b.tar.gz、nao99Jb.tar.gz、
nao99L.tar.gzを展開します。
(~/nao99b/omap): gunzip nao99b.tar.gz
(~/nao99b/omap): tar xvf nao99b.tar
(~/nao99b/omap): gunzip nao99Jb.tar.gz
(~/nao99b/omap): tar xvf nao99Jb.tar
(~/nao99b/omap): gunzip nao99L.tar.gz
(~/nao99b/omap): tar xvf nao99L.tar

必要があれば、他の海洋潮汐モデルも展開します。
(~/nao99b/omap): gunzip got992b.tar.gz
(~/nao99b/omap): tar xvf got992b.tar
(~/nao99b/omap): gunzip csr4.tar.gz
(~/nao99b/omap): tar xvf csr4.tar

nao99bディレクトリでgotic2_041025.tar.gzを展開します。
(~/nao99b/omap): cd ..
(~/nao99b): gunzip gotic2_041025.tar.gz
(~/nao99b): tar xvf gotic2_041025.tar

source ディレクトリにソースコードと Makefile がありますので、
ここでコンパイルして下さい。コンパイルの前に、Makefile中の
FC       = f77
FFLAGS   = 
を環境に合わせて設定してください。

(~/nao99b): cd gotic2/source
(~/nao99b/gotic2/source): make

コンパイルが正常に終了したら、
(~/nao99b/gotic2/source): make clean
として下さい。

dataディレクトリに移動して、潮汐モデルファイルにリンクを張り
ます。
(~/nao99b/gotic2/source): cd ../data
(~/nao99b/gotic2/data): ln -s ../../omap .


9. 動作確認

gotic2 は標準入力から制御ファイルを読み、標準出力に結果を書
き出します。gotic2 ディレクトリにおいて、

(~/nao99b/gotic2): gotic2 < ftn05.exam1 > result.test1

として走らせ、結果のファイル result.test1 と result.exam1 を
比較して見て下さい。result.exam1 は Linux (Fedora core 1) 上
で計算した結果です。なお、これは江刺についてM2分潮の重力を計
算する例です。


10. 例題

○ ftn05.exam2 は三宅島の観測点についてM2分潮の重力を計算す
る場合の制御ファイルです。

*********************[ Mandatory Cards ]**********************
STAPOS   MIYAKE  , 139, 31, 30.0, 34, 7, 13.0, 42.0, 0.0
WAVE     M2
KIND     GV
**********************[ Option Cards ]************************
MESH4    ON
MAPOUT   1, 139.4, 139.6, 34.0, 34.2
END

この観測点は海に近いので、4次メッシュを使います。したがって、
MESH4 ON が必要になります。 

(~/nao99b/gotic2): gotic2 < ftn05.exam2 > result.test2
として走らせます。

MAPOUTカードでGMTに食わせるメッシュ座標データをmapout.xyとい
うファイルに書かせています。GMTをお持ちの方は、mcheck.gmtで
陸メッシュを書かせてみて下さい。赤丸が観測点を表します。


○ ftn05.exam3 は江刺について21分潮の重力を計算する例です。

*********************[ Mandatory Cards ]**********************
STAPOSD ESASHI  , 141.3352777, 39.14805555555555, 393.0, 225.0
WAVE    ALL
KIND    GV
**********************[ Option Cards ]************************
#PREDICT 3, 199801010000, 199802010000, 60.0
#PREXFL  result.test3
#PREFMT  5, 4
#PREOUT  predict.test4
END

WAVE ALL で扱える21分潮すべてを指定しています。オプションカー
ドは全部コメントアウトしてありますが、これは次の時系列予測で
使います。

(~/nao99b/gotic2): gotic2 < ftn05.exam3 > result.test3
として走らせます。時間がかかるので、お茶でもしながら待ちましょ
う(^_^;)。


○ ftn05.exam4 は江刺について重力の時系列予測をする例です。

*********************[ Mandatory Cards ]**********************
STAPOSD ESASHI  , 141.3352777, 39.14805555555555, 393.0, 225.0
WAVE    ALL
KIND    GV
**********************[ Option Cards ]************************
PREDICT 3, 199801010000, 199802010000, 60.0
PREXFL  result.test3
PREFMT  5, 4
PREOUT  predict.test4
END

先程計算した調和定数を result.test3 から読んで、21分潮足し合
わせて時系列予測を行います。なお、デフォルトで18.6年のサイド
バンドは考慮に入れられています。

PREDICT 1, 199801010000, 199802010000, 60.0
は、荷重潮汐の成分を、1998年1月1日00:00UTCから、1998年2月1日
00:00UTCまで、60分間隔で計算することを指定しています。

PREXFL  result.test3
は、result.test3 から調和定数を読むことを指定しています。

PREFMT  5, 4
は、年/月/日 時:分:秒 下向き正の重力値(microGal)の形式で出力
することを指定しています。

PREOUT  predict.test4
は、予測結果を predict.test4 というファイルに出力することを
指定しています。

(~/nao99b/gotic2): gotic2 < ftn05.exam4 > result.test4
として走らせます。


11. 謝辞
GOTIC2 の開発にあたっては、以下の方々のに対するコメントが大
変役にたちました。 

上垣内修 博士
大久保修平 博士
古屋正人 博士
岩崎博幸 博士
大坪俊通 博士
岩野祥子 様

この場を借りて御礼申し上げます m(._.)m


12. お問い合わせ
お問い合わせ、バグレポート、ご要望は
   国立天文台水沢観測所
   松本晃治
   matumoto@miz.nao.ac.jp
までお願いいたします。

長周期潮汐モデルについてのお問い合わせは
   三菱電機（株） 宇宙・衛星通信システム部　宇宙システム課
   高根澤隆
   takaneza@cew.melco.co.jp
までお願いいたします。


13. 更新履歴
2004.10.15
(1) Schwiderskiモデルを用いた荷重の見積もりが正しくなかった
    バグの修正。　
(2) NAO.99JbモデルのOO1, 2N2, Mu2, Nu2分潮が正しく読み込ま
    れていなかったバグの修正。　
(3) 小林ら(2004)による昭和基地周辺詳細海岸線データの包含。
    データ提供ありがとうございました ＞ 小林さん。
    参考文献：
    小林祐樹・岩野祥子・福田洋一, 昭和基地周辺の詳細海岸線
    データの作成および海洋荷重潮汐の計算, 測地学会誌, 第50巻,
    第1号, 17-26頁, 2004.
(4) astro.f中のf2の計算についてのバグの修正。
(5) common文を一部修正。

2001.05.16
(1) 方位角計算のバグ修正(azmth.f)。これまでのヴァージョンで
    は方位角計算にバグがあり、以下の成分の計算に重大な影響を
    与えていました；水平変位のEW成分、傾斜のEW成分、歪の
    shear成分、鉛直線偏差のEW成分。この影響は観測点の経度が0
    度(360度)に近いほど大きく、結果に含まれるエラーも特に大
    きくなっていました。Σ（￣∇￣|||
(2) 0.5度以外の解像度を持つ海洋潮汐モデルに正しく対応してい
    ないバグの修正。

2000.12.01
(1) main.f 中、call convl1で余分な「,」があったのを削除。コ
    ンパイラによってはエラーで止まっていました。
(2) convl1.f 中、datdirの宣言のし忘れを修正。

2000.09.09
(1)メッシュファイルの更新および記述方法の変更。日本国内の観
   測点については、国土地理院の発行している50mメッシュ数値地
   図から作ったメッシュが使えるようになりました。メッシュファ
   イルにヴァージョン1999.06.09との互換性はありません。
(2)FULLMESH、OMODELカードの追加。MAPOUTカードの記述方法の変
   更。
(3)時系列予測のバグの修正。

1999.06.09
一般公開開始。

EOF
